import { getLocales } from 'react-native-localize';

export type Language = 'en' | 'de';

export const getCurrentLanguage = (): Language => {
  const locales = getLocales();
  const primaryLanguage = locales[0]?.languageCode;
  return primaryLanguage === 'de' ? 'de' : 'en';
};

const translations_en = {
  explore: {
    close: 'Close',
    directions: 'Directions',
    filterAll: 'All',
    loading: 'Loading nearby places...',
    navigate: 'Navigate',
    subtitle: 'Discover local recycling centers and resources.',
    title: 'Explore Nearby',
    tooltipCurrentLocation: 'Go to Current Location',
    tooltipLoadArea: 'Load places for this area',
    categories: {
      batteries: 'Batteries',
      bulkyWaste: 'Bulky Waste',
      clothes: 'Clothes',
      electronics: 'Electronics',
      general: 'General',
      glass: 'Glass',
      metal: 'Metal',
      paper: 'Paper',
      plastic: 'Plastic',
    },
  },
  posts: {
    filters: {
      all: 'All',
      giveAway: 'Give Away',
      nearby: 'Nearby',
      requests: 'Requests',
    },
    categories: 'Categories',
    comment: 'Comment',
    latest: 'Latest Posts',
    loading: 'Loading posts...',
    noPosts: 'No posts available.',
    request: 'Request',
    searchPlaceholder: 'Search posts...',
  },
  postCreate: {
    addPhotos: 'Add Photos',
    anonymous: 'Anonymous',
    cancel: 'Cancel',
    category: 'Category',
    categoryPlaceholder: 'Select a category',
    categoryRequired: 'Category is required',
    chooseFromLibrary: 'Choose from Library',
    condition: 'Condition',
    conditionRequired: 'Condition is required',
    configuration: 'Configuration',
    content: 'Content',
    deletePhoto: 'Delete photo',
    description: 'Description',
    descriptionMaxLength: 'Description must be less than 1000 characters',
    descriptionPlaceholder: 'Describe your item...',
    descriptionRequired: 'Description is required',
    detailsContext: 'Details & Context',
    discard: 'Discard',
    discardMessage: 'Are you sure you want to discard this post?',
    discardTitle: 'Discard Post?',
    educationTips: 'Education Tips',
    enterManually: 'Enter Manually',
    error: 'Failed to publish post',
    keepEditing: 'Keep Editing',
    location: 'Location',
    locationErrorMessage: 'Unable to get your current location. Please try again.',
    locationErrorTitle: 'Location Error',
    locationOptional: 'Location (optional)',
    notAnonymous: 'Not Anonymous',
    offline: 'Post saved offline. Will publish when online.',
    photosLimit: 'Up to 4 photos',
    pickupDate: 'Pickup Date',
    pickupDateOptional: 'Pickup Date (optional)',
    postType: 'Post Type',
    postTypeRequired: 'Post type is required',
    preview: 'Preview',
    publish: 'Publish',
    publishing: 'Publishing...',
    reorderPhotos: 'Drag to reorder',
    selectOnMap: 'Select on Map',
    success: 'Post published successfully!',
    tags: 'Tags',
    tagsPlaceholder: 'Add tags...',
    takePhoto: 'Take Photo',
    tip1: 'Add clear photos to increase interest',
    tip2: 'Accurate descriptions help others',
    tip3: 'Tags make your item easier to find',
    title: 'Create Post',
    titleMaxLength: 'Title must be less than 100 characters',
    titleMinLength: 'Title must be at least 3 characters',
    titlePlaceholder: 'Give your item a title',
    titleRequired: 'Title is required',
    uploadingImages: 'Uploading images...',
    useCurrentLocation: 'Use Current Location',
  },
  eventCreate: {
    descriptionMaxLength: 'Description must be less than 1000 characters',
    endTimeAfterStart: 'End time must be after start time',
    locationCountryRequired: 'Country is required',
    locationRequired: 'Location is required',
    locationStreetRequired: 'Street is required',
    startTimeFuture: 'Start time must be in the future',
    startTimeRequired: 'Start time is required',
    titleMaxLength: 'Title must be less than 100 characters',
    titleMinLength: 'Title must be at least 3 characters',
    titleRequired: 'Title is required',
  },
  categories: {
    books: 'Books',
    clothing: 'Clothing',
    electronics: 'Electronics',
    furniture: 'Furniture',
    homeGoods: 'Home Goods',
    other: 'Other',
    sports: 'Sports & Outdoors',
    toys: 'Toys',
  },
  conditions: {
    fair: 'Fair',
    good: 'Good',
    likeNew: 'Like New',
    new: 'New',
    used: 'Used',
  },
  postTypes: {
    event: 'Event',
    general: 'General Post',
    giveaway: 'Giveaway',
    meetup: 'Meetup',
    requests: 'Requests',
  },
  berlinTags: {
    circular: 'Circular Economy',
    donation: 'Donation',
    ecofriendly: 'Eco-Friendly',
    free: 'Free',
    recycling: 'Recycling',
    reuse: 'Reuse',
    sustainable: 'Sustainable',
    swap: 'Swap',
    upcycle: 'Upcycle',
    zerowaste: 'Zero Waste',
  },
  accessibility: {
    addPhotoButton: 'Add photo button',
    anonymousToggle: 'Toggle anonymous posting',
    cancelButton: 'Cancel post creation button',
    categoryPicker: 'Category picker',
    conditionPicker: 'Condition picker',
    datePickerButton: 'Pickup date picker button',
    descriptionInput: 'Item description input',
    dragHandle: 'Drag to reorder image',
    locationButton: 'Location selection button',
    previewCard: 'Post preview card',
    publishButton: 'Publish post button',
    removePhotoButton: 'Remove photo button',
    tagInput: 'Tag input',
    titleInput: 'Item title input',
  },
  onboarding: {
    welcome: {
      title: 'Welcome to ReUseIt!',
      subtitle: 'Your journey to sustainable living starts here',
      description:
        'Join our community of eco-conscious individuals making a difference one recycled item at a time.',
    },
    features: {
      title: 'Discover Amazing Features',
      wasteId: {
        title: 'AI Waste Identification',
        description:
          'Use your camera to identify recyclable materials with our advanced AI technology.',
      },
      community: {
        title: 'Community Marketplace',
        description: 'Buy, sell, and give away items in our sustainable marketplace.',
      },
      events: {
        title: 'Local Events',
        description: 'Join recycling events and meetups in your area.',
      },
    },
    permissions: {
      title: 'Enable Permissions',
      subtitle: 'To provide the best experience',
      camera: {
        title: 'Camera Access',
        description: 'Take photos of waste items for identification',
      },
      location: {
        title: 'Location Services',
        description: 'Find nearby recycling centers and events',
      },
      notifications: {
        title: 'Push Notifications',
        description: 'Get updates on events and community activities',
      },
      request: 'Request Permissions',
    },
    getStarted: 'Get Started',
    next: 'Next',
    skip: 'Skip',
  },
  profile: {
    title: 'Profile',
    settings: 'Settings & Privacy',
    myPosts: 'My Posts',
    chatRequests: 'Chat Requests',
    exportData: 'Export My Data',
    deleteAccount: 'Delete My Account',
    signOut: 'Sign Out',
    editProfile: 'Edit Profile',
    save: 'Save',
    cancel: 'Cancel',
    name: 'Name',
    username: 'Username',
    email: 'Email',
    phone: 'Phone Number',
    avatar: 'Avatar',
    nameRequired: 'Name is required',
    nameMinLength: 'Name must be at least 2 characters',
    usernameMinLength: 'Username must be at least 3 characters',
    usernamePattern: 'Username can only contain letters, numbers, and underscores',
    phoneInvalid: 'Please enter a valid phone number',
    updateSuccess: 'Profile updated successfully',
    updateError: 'Failed to update profile',
    exportSuccess: 'Data export initiated. You will receive an email shortly.',
    exportError: 'Failed to export data',
    deleteConfirmTitle: 'Delete Account',
    deleteConfirmMessage:
      'Are you sure you want to delete your account? This action cannot be undone. All your data will be permanently removed.',
    deleteConfirmButton: 'Delete Account',
    deleteSuccess: 'Account deleted successfully',
    deleteError: 'Failed to delete account',
    privacyPolicy: 'Privacy Policy',
  },
} as const;

type Widen<T> = {
  [K in keyof T]: T[K] extends object ? Widen<T[K]> : string;
};

export type TranslationObject = Widen<typeof translations_en>;

type TranslationKey<T = TranslationObject> = {
  [K in keyof T & string]: T[K] extends string
    ? `${K}` // leaf
    : `${K}` | `${K}.${TranslationKey<T[K]>}`; // nested
}[keyof T & string];

export const translations: Record<string, TranslationObject> = {
  en: translations_en,
  de: {
    explore: {
      close: 'Schließen',
      directions: 'Route',
      filterAll: 'Alle',
      loading: 'Lade Orte in deiner Nähe...',
      navigate: 'Navigieren',
      subtitle: 'Entdecken Sie lokale Recyclingzentren und Ressourcen.',
      title: 'In der Nähe erkunden',
      tooltipCurrentLocation: 'Zum aktuellen Standort gehen',
      tooltipLoadArea: 'Orte für diesen Bereich laden',
      categories: {
        batteries: 'Batterien',
        bulkyWaste: 'Sperrmüll',
        clothes: 'Kleidung',
        electronics: 'Elektronik',
        general: 'Allgemein',
        glass: 'Glas',
        metal: 'Metall',
        paper: 'Papier',
        plastic: 'Plastik',
      },
    },
    posts: {
      filters: {
        all: 'Alle',
        giveAway: 'Verschenken',
        nearby: 'In der Nähe',
        requests: 'Anfragen',
      },
      categories: 'Kategorien',
      comment: 'Kommentieren',
      latest: 'Neueste Beiträge',
      loading: 'Beiträge laden...',
      noPosts: 'Keine Beiträge verfügbar.',
      request: 'Anfragen',
      searchPlaceholder: 'Beiträge suchen...',
    },
    postCreate: {
      addPhotos: 'Fotos hinzufügen',
      anonymous: 'Anonym',
      cancel: 'Abbrechen',
      category: 'Kategorie',
      categoryPlaceholder: 'Kategorie auswählen',
      categoryRequired: 'Kategorie ist erforderlich',
      chooseFromLibrary: 'Aus Bibliothek wählen',
      condition: 'Zustand',
      conditionRequired: 'Zustand ist erforderlich',
      configuration: 'Konfiguration',
      content: 'Inhalt',
      deletePhoto: 'Foto löschen',
      description: 'Beschreibung',
      descriptionMaxLength: 'Beschreibung muss weniger als 1000 Zeichen lang sein',
      descriptionPlaceholder: 'Beschreiben Sie Ihren Artikel...',
      descriptionRequired: 'Beschreibung ist erforderlich',
      detailsContext: 'Details & Kontext',
      discard: 'Verwerfen',
      discardMessage: 'Möchten Sie diesen Beitrag wirklich verwerfen?',
      discardTitle: 'Beitrag verwerfen?',
      educationTips: 'Bildungstipps',
      enterManually: 'Manuell eingeben',
      error: 'Beitrag konnte nicht veröffentlicht werden',
      keepEditing: 'Weiter bearbeiten',
      location: 'Standort',
      locationErrorTitle: 'Standortfehler',
      locationErrorMessage:
        'Ihr aktueller Standort konnte nicht abgerufen werden. Bitte versuchen Sie es erneut.',
      locationOptional: 'Standort (optional)',
      notAnonymous: 'Nicht anonym',
      offline: 'Beitrag offline gespeichert. Wird veröffentlicht, wenn online.',
      photosLimit: 'Bis zu 4 Fotos',
      pickupDate: 'Abholdatum',
      pickupDateOptional: 'Abholdatum (optional)',
      postType: 'Beitragsart',
      postTypeRequired: 'Beitragsart ist erforderlich',
      preview: 'Vorschau',
      publish: 'Veröffentlichen',
      publishing: 'Veröffentlichen...',
      reorderPhotos: 'Zum Neuordnen ziehen',
      selectOnMap: 'Auf Karte auswählen',
      success: 'Beitrag erfolgreich veröffentlicht!',
      tags: 'Tags',
      tagsPlaceholder: 'Tags hinzufügen...',
      takePhoto: 'Foto aufnehmen',
      tip1: 'Fügen Sie klare Fotos hinzu, um das Interesse zu erhöhen',
      tip2: 'Genaue Beschreibungen helfen anderen',
      tip3: 'Tags machen Ihren Artikel leichter auffindbar',
      title: 'Beitrag erstellen',
      titleMaxLength: 'Titel muss weniger als 100 Zeichen lang sein',
      titleMinLength: 'Titel muss mindestens 3 Zeichen lang sein',
      titlePlaceholder: 'Geben Sie Ihrem Artikel einen Titel',
      titleRequired: 'Titel ist erforderlich',
      uploadingImages: 'Bilder hochladen...',
      useCurrentLocation: 'Aktuellen Standort verwenden',
    },
    eventCreate: {
      descriptionMaxLength: 'Beschreibung muss weniger als 1000 Zeichen lang sein',
      endTimeAfterStart: 'Endzeit muss nach der Startzeit liegen',
      locationCountryRequired: 'Land ist erforderlich',
      locationRequired: 'Standort ist erforderlich',
      locationStreetRequired: 'Straße ist erforderlich',
      startTimeFuture: 'Startzeit muss in der Zukunft liegen',
      startTimeRequired: 'Startzeit ist erforderlich',
      titleMaxLength: 'Titel muss weniger als 100 Zeichen lang sein',
      titleMinLength: 'Titel muss mindestens 3 Zeichen lang sein',
      titleRequired: 'Titel ist erforderlich',
    },
    categories: {
      books: 'Bücher',
      clothing: 'Kleidung',
      electronics: 'Elektronik',
      furniture: 'Möbel',
      homeGoods: 'Haushaltswaren',
      other: 'Sonstiges',
      sports: 'Sport & Outdoor',
      toys: 'Spielzeug',
    },
    conditions: {
      fair: 'Akzeptabel',
      good: 'Gut',
      likeNew: 'Wie neu',
      new: 'Neu',
      used: 'Gebraucht',
    },
    postTypes: {
      event: 'Veranstaltung',
      general: 'Allgemeiner Beitrag',
      giveaway: 'Verlosung',
      meetup: 'Treffen',
      requests: 'Anfragen',
    },
    berlinTags: {
      circular: 'Kreislaufwirtschaft',
      donation: 'Spende',
      ecofriendly: 'Umweltfreundlich',
      free: 'Kostenlos',
      recycling: 'Recycling',
      reuse: 'Wiederverwenden',
      sustainable: 'Nachhaltig',
      swap: 'Tauschen',
      upcycle: 'Upcycling',
      zerowaste: 'Zero Waste',
    },
    accessibility: {
      addPhotoButton: 'Foto hinzufügen Schaltfläche',
      anonymousToggle: 'Anonymes Posten umschalten',
      cancelButton: 'Beitragserstellung abbrechen Schaltfläche',
      categoryPicker: 'Kategorieauswahl',
      conditionPicker: 'Zustandsauswahl',
      datePickerButton: 'Abholdatum Auswahl Schaltfläche',
      descriptionInput: 'Artikelbeschreibungs-Eingabe',
      dragHandle: 'Zum Neuordnen des Bildes ziehen',
      locationButton: 'Standortauswahl Schaltfläche',
      previewCard: 'Beitragsvorschau-Karte',
      publishButton: 'Beitrag veröffentlichen Schaltfläche',
      removePhotoButton: 'Foto entfernen Schaltfläche',
      tagInput: 'Tag-Eingabe',
      titleInput: 'Artikeltitel-Eingabe',
    },
    onboarding: {
      welcome: {
        title: 'Willkommen bei ReUseIt!',
        subtitle: 'Ihre Reise zu nachhaltigem Leben beginnt hier',
        description:
          'Treten Sie unserer Gemeinschaft von umweltbewussten Menschen bei, die einen Unterschied machen, einen recycelten Gegenstand nach dem anderen.',
      },
      features: {
        title: 'Entdecken Sie tolle Funktionen',
        wasteId: {
          title: 'KI-Abfallidentifikation',
          description:
            'Verwenden Sie Ihre Kamera, um recycelbare Materialien mit unserer fortschrittlichen KI-Technologie zu identifizieren.',
        },
        community: {
          title: 'Gemeinschafts-Marktplatz',
          description:
            'Kaufen, verkaufen und verschenken Sie Artikel in unserem nachhaltigen Marktplatz.',
        },
        events: {
          title: 'Lokale Events',
          description: 'Nehmen Sie an Recycling-Events und Treffen in Ihrer Nähe teil.',
        },
      },
      permissions: {
        title: 'Berechtigungen aktivieren',
        subtitle: 'Für das beste Erlebnis',
        camera: {
          title: 'Kamerazugriff',
          description: 'Machen Sie Fotos von Abfallgegenständen zur Identifizierung',
        },
        location: {
          title: 'Standortdienste',
          description: 'Finden Sie nahegelegene Recyclingzentren und Events',
        },
        notifications: {
          title: 'Push-Benachrichtigungen',
          description: 'Erhalten Sie Updates zu Events und Community-Aktivitäten',
        },
        request: 'Berechtigungen anfordern',
      },
      getStarted: 'Loslegen',
      next: 'Weiter',
      skip: 'Überspringen',
    },
    profile: {
      title: 'Profil',
      settings: 'Einstellungen & Datenschutz',
      myPosts: 'Meine Beiträge',
      chatRequests: 'Chat-Anfragen',
      exportData: 'Meine Daten exportieren',
      deleteAccount: 'Konto löschen',
      signOut: 'Abmelden',
      editProfile: 'Profil bearbeiten',
      save: 'Speichern',
      cancel: 'Abbrechen',
      name: 'Name',
      username: 'Benutzername',
      email: 'E-Mail',
      phone: 'Telefonnummer',
      avatar: 'Avatar',
      nameRequired: 'Name ist erforderlich',
      nameMinLength: 'Name muss mindestens 2 Zeichen lang sein',
      usernameMinLength: 'Benutzername muss mindestens 3 Zeichen lang sein',
      usernamePattern: 'Benutzername darf nur Buchstaben, Zahlen und Unterstriche enthalten',
      phoneInvalid: 'Bitte geben Sie eine gültige Telefonnummer ein',
      updateSuccess: 'Profil erfolgreich aktualisiert',
      updateError: 'Profil konnte nicht aktualisiert werden',
      exportSuccess: 'Datenexport initiiert. Sie erhalten in Kürze eine E-Mail.',
      exportError: 'Datenexport fehlgeschlagen',
      deleteConfirmTitle: 'Konto löschen',
      deleteConfirmMessage:
        'Sind Sie sicher, dass Sie Ihr Konto löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden. Alle Ihre Daten werden dauerhaft entfernt.',
      deleteConfirmButton: 'Konto löschen',
      deleteSuccess: 'Konto erfolgreich gelöscht',
      deleteError: 'Konto konnte nicht gelöscht werden',
      privacyPolicy: 'Datenschutzrichtlinie',
    },
  },
};

export const t = (key: TranslationKey, lang?: Language): string => {
  const language = lang || getCurrentLanguage();
  const keys = key.split('.');
  let value: Record<string, unknown> | string = translations[language];

  for (const k of keys) {
    if (typeof value === 'string') break;
    value = (value as Record<string, unknown>)?.[k] as Record<string, unknown> | string;
  }

  return typeof value === 'string' ? value : key;
};
